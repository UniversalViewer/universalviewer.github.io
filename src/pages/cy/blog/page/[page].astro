---
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const perPage = 2;
  const posts = await getCollection('blog');
  const totalPages = Math.max(1, Math.ceil(posts.length / perPage));

  const paths = [];

  for (let i = 1; i <= totalPages; i++) {
    const target = i === 1 ? '/blog' : `/blog/page/${i}`;

    paths.push({
      params: { page: i },
      props: { target },
    });
  }

  return paths;
}

const { target } = Astro.props;
---

<head>
  <meta
    http-equiv="refresh"
    content={`0; url=${target}`}
  />
  <meta
    name="robots"
    content="noindex"
  />
  <link
    rel="canonical"
    href={target}
  />
</head>
<body>
  <a href={target}>Redirecting to {target}â€¦</a>
</body>
