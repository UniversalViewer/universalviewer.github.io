---
import { Debug } from 'astro:components';
import { getLangFromUrl, useTranslations } from '@i18n/utils';
const locale = Astro.currentLocale;
const urlPrefix = locale === 'en' ? '' : `/${locale}`;
const currentPath = Astro.url.pathname;
const href = (p: string) => `${urlPrefix}${p}`;
const currentPathWithoutLocale = currentPath.replace(urlPrefix, '') || '/';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<header class="site-header">
  <a
    href={href('')}
    class="logo-link"
  >
    <img
      src=""
      alt=""
      class="logo-image"
    />
  </a>
  <nav class="main-nav">
    <ul class="main-nav-list">
      <li class="main-nav-list-item">
        <a
          href={href('/')}
          class="main-nav-link"
          >{t('nav.home')}</a
        >
      </li>
      <li class="main-nav-list-item">
        <a
          href={href('/demo')}
          class="main-nav-link"
          >{t('nav.demo')}</a
        >
      </li>
      <li class="main-nav-list-item">
        <a
          href={href('/events')}
          class="main-nav-link"
          >{t('nav.events')}</a
        >
      </li>
      <li class="main-nav-list-item">
        <a
          href={href('/docs')}
          class="main-nav-link"
          >{t('nav.documentation')}</a
        >
      </li>
      <li class="main-nav-list-item">
        <a
          href="/blog"
          class="main-nav-link"
          >{t('nav.blog')}</a
        >
      </li>
      <li class="main-nav-list-item">
        <a
          href={href('/community')}
          class="main-nav-link"
          >{t('nav.community')}</a
        >
      </li>
    </ul>
  </nav>
  <div class="languages-container">
    <button
      type="button"
      id="showLanguagesButton"
      class="show-languages-button"
      aria-label="Select language"
      aria-expanded="false"
      >{locale}</button
    >
    <nav
      id="langNav"
      class="lang-nav"
    >
      <ul class="lang-nav-list">
        <li class="lang-nav-list-item">
          <a
            href={currentPathWithoutLocale}
            class="lang-nav-link"
            >en</a
          >
        </li>
        <li class="lang-nav-list-item">
          <a
            href={`/cy${currentPathWithoutLocale}`}
            class="lang-nav-link"
            >cy</a
          >
        </li>
      </ul>
    </nav>
  </div>
</header>
<script>
  const langButton = document.getElementById('showLanguagesButton');
  const langNav = document.getElementById('langNav');
  langButton?.addEventListener('click', () => {
    langNav?.classList.toggle('show');
  });

  document.addEventListener('click', (e) => {
    if (e.target != langButton) {
      langNav?.classList.remove('show');
    }
  });
</script>
